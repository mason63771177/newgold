<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ§åˆ¶å°é”™è¯¯æ£€æŸ¥å™¨</title>
    <style>
        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .title {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 8px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
        }
        .error-log {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
            line-height: 1.6;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 16px;
        }
        .error { color: #e74c3c; }
        .warning { color: #f39c12; }
        .info { color: #3498db; }
        .success { color: #27ae60; }
        .timestamp { color: #95a5a6; font-size: 11px; }
        .step {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 16px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
        }
        .step-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        .iframe-container {
            position: relative;
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 16px;
        }
        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="panel">
            <div class="title">
                ğŸ” ä¸»é¡µé¢é”™è¯¯æ£€æŸ¥å™¨
            </div>
            
            <div class="step">
                <div class="step-title">æ­¥éª¤1: è‡ªåŠ¨æ£€æŸ¥ä¸»é¡µé¢</div>
                <button class="btn" onclick="loadMainPageInFrame()">åœ¨æ¡†æ¶ä¸­åŠ è½½ä¸»é¡µé¢</button>
                <button class="btn" onclick="checkMainPageErrors()">æ£€æŸ¥JavaScripté”™è¯¯</button>
                <button class="btn" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            </div>
            
            <div class="step">
                <div class="step-title">æ­¥éª¤2: æ‰‹åŠ¨æ£€æŸ¥ï¼ˆæ¨èï¼‰</div>
                <p>1. ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ä¸»é¡µé¢</p>
                <p>2. åœ¨ä¸»é¡µé¢æŒ‰ <code>F12</code> æ‰“å¼€å¼€å‘è€…å·¥å…·</p>
                <p>3. æŸ¥çœ‹ <strong>Console</strong> æ ‡ç­¾é¡µä¸­çš„é”™è¯¯ä¿¡æ¯</p>
                <p>4. å°†é”™è¯¯ä¿¡æ¯å¤åˆ¶ç»™æˆ‘</p>
                <button class="btn" onclick="openMainPageInNewTab()">åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ä¸»é¡µé¢</button>
            </div>
            
            <div id="errorLog" class="error-log">ç­‰å¾…æ£€æŸ¥ç»“æœ...</div>
            
            <div id="iframeContainer" class="iframe-container" style="display: none;">
                <iframe id="mainPageFrame" src=""></iframe>
            </div>
        </div>
    </div>

    <script>
        const errorLog = document.getElementById('errorLog');
        let originalConsoleError = console.error;
        let originalConsoleWarn = console.warn;
        let originalConsoleLog = console.log;
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const typeClass = type;
            const logEntry = `<span class="timestamp">[${timestamp}]</span> <span class="${typeClass}">${message}</span>\n`;
            errorLog.innerHTML += logEntry;
            errorLog.scrollTop = errorLog.scrollHeight;
        }
        
        function clearLog() {
            errorLog.innerHTML = 'æ—¥å¿—å·²æ¸…ç©ºï¼Œç­‰å¾…æ–°çš„æ£€æŸ¥ç»“æœ...\n';
        }
        
        function openMainPageInNewTab() {
            log('æ­£åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ä¸»é¡µé¢...', 'info');
            window.open('http://localhost:3001', '_blank');
            log('âœ“ ä¸»é¡µé¢å·²åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€', 'success');
            log('è¯·åœ¨æ–°æ ‡ç­¾é¡µä¸­æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹Consoleä¸­çš„é”™è¯¯', 'info');
        }
        
        function loadMainPageInFrame() {
            log('æ­£åœ¨æ¡†æ¶ä¸­åŠ è½½ä¸»é¡µé¢...', 'info');
            const iframe = document.getElementById('mainPageFrame');
            const container = document.getElementById('iframeContainer');
            
            iframe.src = 'http://localhost:3001';
            container.style.display = 'block';
            
            iframe.onload = function() {
                log('âœ“ ä¸»é¡µé¢å·²åœ¨æ¡†æ¶ä¸­åŠ è½½å®Œæˆ', 'success');
                setTimeout(() => {
                    checkFrameContent();
                }, 2000);
            };
            
            iframe.onerror = function() {
                log('âœ— ä¸»é¡µé¢åŠ è½½å¤±è´¥', 'error');
            };
        }
        
        function checkFrameContent() {
            try {
                const iframe = document.getElementById('mainPageFrame');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                log('å¼€å§‹æ£€æŸ¥æ¡†æ¶ä¸­çš„é¡µé¢å†…å®¹...', 'info');
                
                // æ£€æŸ¥åŸºæœ¬å…ƒç´ 
                const elements = ['app', 'stateLabel', 'subtitle', 'card', 'bottomButtons'];
                elements.forEach(id => {
                    const el = iframeDoc.getElementById(id);
                    if (el) {
                        const content = el.textContent || el.innerHTML;
                        log(`âœ“ æ‰¾åˆ° #${id}: ${content.substring(0, 50)}${content.length > 50 ? '...' : ''}`, 'success');
                    } else {
                        log(`âœ— æœªæ‰¾åˆ° #${id}`, 'error');
                    }
                });
                
                // æ£€æŸ¥é¡µé¢æ ‡é¢˜
                const title = iframeDoc.title;
                log(`é¡µé¢æ ‡é¢˜: ${title}`, 'info');
                
                // æ£€æŸ¥æ˜¯å¦æœ‰å†…å®¹
                const body = iframeDoc.body;
                if (body && body.innerHTML.trim()) {
                    log('âœ“ é¡µé¢æœ‰å†…å®¹', 'success');
                } else {
                    log('âœ— é¡µé¢å†…å®¹ä¸ºç©º', 'error');
                }
                
            } catch (e) {
                log(`æ£€æŸ¥æ¡†æ¶å†…å®¹æ—¶å‡ºé”™: ${e.message}`, 'error');
                log('è¿™å¯èƒ½æ˜¯ç”±äºè·¨åŸŸé™åˆ¶ï¼Œå»ºè®®ä½¿ç”¨æ‰‹åŠ¨æ£€æŸ¥æ–¹æ³•', 'warning');
            }
        }
        
        function checkMainPageErrors() {
            log('å¼€å§‹æ£€æŸ¥ä¸»é¡µé¢çš„JavaScripté”™è¯¯...', 'info');
            
            // é‡å†™consoleæ–¹æ³•æ¥æ•è·é”™è¯¯
            window.addEventListener('error', function(e) {
                log(`JavaScripté”™è¯¯: ${e.message} (${e.filename}:${e.lineno})`, 'error');
            });
            
            window.addEventListener('unhandledrejection', function(e) {
                log(`Promiseé”™è¯¯: ${e.reason}`, 'error');
            });
            
            // å°è¯•åœ¨æ–°çª—å£ä¸­æ‰“å¼€å¹¶ç›‘å¬é”™è¯¯
            const newWindow = window.open('http://localhost:3001', 'mainPageCheck');
            
            if (newWindow) {
                log('âœ“ å·²åœ¨æ–°çª—å£æ‰“å¼€ä¸»é¡µé¢è¿›è¡Œæ£€æŸ¥', 'success');
                
                setTimeout(() => {
                    try {
                        // å°è¯•è®¿é—®æ–°çª—å£çš„console
                        if (newWindow.console) {
                            log('æ­£åœ¨ç›‘å¬æ–°çª—å£çš„é”™è¯¯...', 'info');
                        }
                    } catch (e) {
                        log('æ— æ³•ç›´æ¥è®¿é—®æ–°çª—å£çš„consoleï¼Œè¯·æ‰‹åŠ¨æ£€æŸ¥', 'warning');
                    }
                }, 2000);
            } else {
                log('âœ— æ— æ³•æ‰“å¼€æ–°çª—å£ï¼Œè¯·æ‰‹åŠ¨æ‰“å¼€ä¸»é¡µé¢æ£€æŸ¥', 'error');
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.onload = function() {
            log('é”™è¯¯æ£€æŸ¥å™¨å·²å‡†å¤‡å°±ç»ª', 'success');
            log('è¯·é€‰æ‹©æ£€æŸ¥æ–¹å¼ï¼šè‡ªåŠ¨æ£€æŸ¥æˆ–æ‰‹åŠ¨æ£€æŸ¥', 'info');
        };
    </script>
</body>
</html>