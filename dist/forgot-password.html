<!DOCTYPE html>
<html lang="zh-CN" data-theme="business">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>裂金7日 · 忘记密码</title>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QQ6GQ79K7G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QQ6GQ79K7G');
  </script>
  
  <style>:root{--bg-primary:linear-gradient(135deg,#0c0c0c,#1a1a2e 50%,#16213e);--bg-secondary:rgba(26,26,46,.8);--bg-card:linear-gradient(145deg,rgba(22,33,62,.9),rgba(26,26,46,.7));--text-primary:#fff;--text-secondary:#6dd5ed;--text-accent:#2193b0;--btn-gradient:linear-gradient(45deg,#2193b0,#6dd5ed);--btn-shadow:0 8px 32px rgba(33,147,176,.3);--btn-glow:0 0 20px rgba(109,213,237,.4);--border-color:rgba(109,213,237,.3);--accent-color:#6dd5ed;--logo-filter:drop-shadow(0 0 8px rgba(109,213,237,.4));--bg:#0b0f14;--panel:#111823;--card:#0e141d;--brand:#56ccf2;--brand-2:#2f80ed;--text:#e6efff;--muted:#9fb3cd;--danger:#ff5d5d;--ok:#1ed760;--safe:env(safe-area-inset-bottom,0px)}[data-theme=business]{--bg-primary:linear-gradient(135deg,#2c3e50,#34495e 50%,#2c3e50);--bg-secondary:rgba(52,73,94,.8);--bg-card:linear-gradient(145deg,rgba(44,62,80,.9),rgba(52,73,94,.7));--text-primary:#ecf0f1;--text-secondary:#f39c12;--text-accent:#e67e22;--btn-gradient:linear-gradient(45deg,#f39c12,#e67e22);--btn-shadow:0 8px 32px rgba(243,156,18,.3);--btn-glow:0 0 20px rgba(243,156,18,.4);--border-color:rgba(243,156,18,.3);--accent-color:#f39c12;--logo-filter:drop-shadow(0 0 8px rgba(243,156,18,.5));--bg:linear-gradient(135deg,#2c3e50,#34495e 50%,#2c3e50);--panel:rgba(52,73,94,.8);--card:linear-gradient(145deg,rgba(44,62,80,.9),rgba(52,73,94,.7));--brand:#f39c12;--brand-2:#e67e22;--text:#ecf0f1;--muted:#bdc3c7;--danger:#e74c3c;--ok:#27ae60}[data-theme=cyberpunk]{--bg-primary:linear-gradient(135deg,#0a0a0a,#1a0d1a 25%,#0d1a1a 50%,#1a1a0d 75%,#0a0a0a);--bg-secondary:rgba(26,13,26,.95);--bg-card:linear-gradient(145deg,rgba(26,26,13,.9),rgba(13,26,26,.8));--text-primary:#00ff41;--text-secondary:#ff0080;--text-accent:#00d4ff;--btn-gradient:linear-gradient(45deg,#ff0080,#00ff41,#00d4ff,#ff0080);--btn-shadow:0 8px 32px rgba(255,0,128,.5);--btn-glow:0 0 25px rgba(0,255,65,.6),0 0 50px rgba(255,0,128,.4),0 0 75px rgba(0,212,255,.3);--border-color:rgba(0,255,65,.5);--accent-color:#00ff41;--logo-filter:drop-shadow(0 0 15px rgba(0,255,65,.8)) drop-shadow(0 0 30px rgba(255,0,128,.6))}[data-theme=cyberpunk] .btn{animation:cyberpunk-glow 2s ease-in-out infinite alternate}@keyframes cyberpunk-glow{0%{box-shadow:var(--btn-shadow),var(--btn-glow);filter:brightness(1)}to{box-shadow:var(--btn-shadow),0 0 35px rgba(0,255,65,.8),0 0 70px rgba(255,0,128,.6),0 0 105px rgba(0,212,255,.4);filter:brightness(1.2)}}*{box-sizing:border-box;transition:background .3s ease,color .3s ease,border-color .3s ease,box-shadow .3s ease}body,html{align-items:center;background:var(--bg-primary);background-attachment:fixed;color:var(--text-primary);display:flex;font-family:-apple-system,BlinkMacSystemFont,SF Pro Display,Segoe UI,PingFang SC,Helvetica,Arial,Microsoft Yahei,sans-serif;height:100%;justify-content:center;margin:0;overflow-x:hidden;padding:20px;position:relative}body:before{animation:float 20s ease-in-out infinite;background:radial-gradient(circle at 30% 20%,rgba(255,215,0,.1) 0,transparent 50%),radial-gradient(circle at 70% 80%,rgba(255,165,0,.08) 0,transparent 50%);content:"";height:200%;left:-50%;pointer-events:none;position:fixed;top:-50%;width:200%;z-index:0}@keyframes float{0%,to{transform:translate(0) rotate(0deg)}33%{transform:translate(-20px,-20px) rotate(1deg)}66%{transform:translate(20px,-10px) rotate(-1deg)}}.app{align-items:center;display:flex;flex-direction:column;min-height:100vh;padding:24px}h1{background:linear-gradient(135deg,gold,#ffb347);-webkit-background-clip:text;background-clip:text;font-size:28px;font-weight:700;letter-spacing:1px;margin-bottom:30px;margin-top:0;text-align:center;-webkit-text-fill-color:transparent;position:relative}.subtitle{color:hsla(0,0%,100%,.7);font-size:14px;font-weight:400;margin-bottom:25px;text-align:center}.challenge-badge{background:linear-gradient(135deg,rgba(255,215,0,.2),rgba(255,179,71,.2));border:1px solid rgba(255,215,0,.3);border-radius:20px;color:gold;display:inline-block;font-size:12px;font-weight:500;margin-bottom:20px;padding:4px 12px}.logo-small{height:80px;margin:0 auto 16px;width:80px}.logo,.logo-small{display:block;filter:var(--logo-filter);-o-object-fit:contain;object-fit:contain}.logo{height:150px;margin:0 auto 20px;width:150px}.card{backdrop-filter:blur(20px);background:rgba(14,20,29,.95);border:1px solid rgba(255,215,0,.2);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.4),0 0 0 1px rgba(255,215,0,.1),inset 0 1px 0 hsla(0,0%,100%,.1);max-width:400px;padding:40px 30px;position:relative;transition:all .3s ease;width:100%;z-index:1}.card:hover{box-shadow:0 25px 50px rgba(0,0,0,.5),0 0 0 1px rgba(255,215,0,.2),inset 0 1px 0 hsla(0,0%,100%,.1);transform:translateY(-2px)}.card>div{margin-bottom:16px}.card>div:last-child{margin-bottom:0}label{display:block;font-size:14px;font-weight:500;margin-bottom:8px}input,label{color:var(--text)}input{background:hsla(0,0%,100%,.05);border:1px solid hsla(0,0%,100%,.15);border-radius:8px;font-size:16px;padding:12px 16px;transition:all .2s ease;width:100%}input:focus{background:hsla(0,0%,100%,.08);border-color:var(--brand);outline:none}input::-moz-placeholder{color:var(--muted)}input::placeholder{color:var(--muted)}.btn{background:var(--btn-gradient);border:none;border-radius:12px;box-shadow:var(--btn-shadow);color:var(--text-primary);cursor:pointer;font-size:16px;font-weight:700;margin-top:8px;min-height:48px;overflow:hidden;padding:16px 24px;position:relative;transition:all .3s ease;width:100%}.btn:before{background:linear-gradient(90deg,transparent,hsla(0,0%,100%,.3),transparent);content:"";height:100%;left:-100%;position:absolute;top:0;transition:left .5s ease;width:100%}.btn:hover:before{left:100%}.btn:hover{box-shadow:var(--btn-glow);transform:translateY(-2px)}.btn:active{transform:translateY(0)}.btn:disabled{cursor:not-allowed;opacity:.6;transform:none}.loading-btn{color:transparent;position:relative}.loading-btn:after{animation:spin 1s linear infinite;border:2px solid #0b0f14;border-radius:50%;border-top-color:transparent;content:"";height:20px;left:50%;margin:-10px 0 0 -10px;position:absolute;top:50%;width:20px}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.note{line-height:1.4;margin-top:8px}.foot,.note{color:var(--muted);font-size:12px}.foot{margin-top:40px;text-align:center}.forgot-icon{filter:var(--logo-filter);font-size:80px;margin-bottom:20px;text-align:center}.forgot-title{background:linear-gradient(135deg,gold,#ffb347);-webkit-background-clip:text;background-clip:text;font-size:28px;font-weight:700;margin-bottom:15px;text-align:center;-webkit-text-fill-color:transparent}.forgot-message{color:var(--muted);font-size:14px;line-height:1.6;margin-bottom:30px;text-align:center}.form-group{margin-bottom:20px;position:relative}.form-group.error input{background:rgba(255,93,93,.1);border-color:var(--danger)}.form-group.success input{background:rgba(30,215,96,.1);border-color:var(--ok)}.btn-secondary{background:linear-gradient(45deg,hsla(0,0%,100%,.1),hsla(0,0%,100%,.05));border:1px solid var(--border-color);color:var(--text-secondary);margin-top:16px}.btn-secondary:hover{background:linear-gradient(45deg,hsla(0,0%,100%,.15),hsla(0,0%,100%,.1));box-shadow:0 8px 32px hsla(0,0%,100%,.1)}.hidden{display:none}.error-message{background:linear-gradient(135deg,rgba(255,93,93,.2),rgba(255,93,93,.1));border:1px solid rgba(255,93,93,.3);border-radius:8px;color:var(--danger)}.error-message,.success-message{font-size:14px;margin-bottom:20px;padding:12px 16px}.success-message{background:linear-gradient(135deg,rgba(30,215,96,.2),rgba(30,215,96,.1));border:1px solid rgba(30,215,96,.3);border-radius:8px;color:var(--ok)}.info-box{background:linear-gradient(135deg,rgba(255,215,0,.1),rgba(255,179,71,.05));border:1px solid rgba(255,215,0,.2);border-radius:12px;color:var(--text-secondary);font-size:13px;margin-top:20px;padding:16px}.info-box h4{color:var(--accent-color);font-size:14px;font-weight:600;margin:0 0 10px}.info-box ul{margin:0;padding-left:20px}.info-box li{line-height:1.4;margin-bottom:5px}.success{color:var(--ok)}.error{color:var(--danger)}.security-tip{align-items:center;background:hsla(0,0%,100%,.03);border:1px solid hsla(0,0%,100%,.05);border-radius:6px;color:var(--muted);display:flex;font-size:12px;gap:8px;margin-top:6px;padding:8px 12px}.security-icon{font-size:14px;opacity:.8}</style>
  <link rel="stylesheet" crossorigin href="/newgold/assets/css/global-background-D97W4UkV.css">
</head>
<body>
  <div class="app">
    <div class="card">
      <!-- 申请重置表单 -->
      <div id="requestForm">
        <div class="forgot-icon">🔑</div>
        <h1 class="forgot-title">忘记密码</h1>
        <p class="forgot-message">
          请输入您注册时使用的邮箱地址，我们将向您发送密码重置链接。
        </p>

        <div id="errorDiv" class="error-message hidden"></div>
        <div id="successDiv" class="success-message hidden"></div>

        <form onsubmit="requestPasswordReset(event)">
          <div class="form-group">
            <label for="email">邮箱地址</label>
            <input type="email" id="email" required 
                   placeholder="请输入您的邮箱地址">
            <div class="security-tip">
              <div class="security-icon">📧</div>
              <span>我们将向此邮箱发送重置链接</span>
            </div>
          </div>

          <button type="submit" class="btn" id="requestBtn">发送重置邮件</button>
        </form>

        <a href="login.html" class="btn btn-secondary">返回登录</a>

        <div class="info-box">
          <h4>📋 重要提醒</h4>
          <ul>
            <li>重置链接将在1小时后过期</li>
            <li>请检查垃圾邮件文件夹</li>
            <li>如果没有收到邮件，请检查邮箱地址是否正确</li>
            <li>每15分钟最多可申请5次重置</li>
          </ul>
        </div>
      </div>

      <!-- 成功状态 -->
      <div id="successState" class="hidden">
        <div class="forgot-icon success">📧</div>
        <h1 class="forgot-title success">邮件已发送！</h1>
        <div class="success-message">
          如果该邮箱已注册，您将收到密码重置邮件。请检查您的邮箱并点击重置链接。
        </div>
        <p class="forgot-message">
          没有收到邮件？请检查垃圾邮件文件夹，或者等待几分钟后重试。
        </p>
        <button onclick="showRequestForm()" class="btn btn-secondary">重新发送</button>
        <a href="login.html" class="btn">返回登录</a>

        <div class="info-box">
          <h4>⏰ 下一步操作</h4>
          <ul>
            <li>打开您的邮箱</li>
            <li>查找来自 裂金7日 的邮件</li>
            <li>点击邮件中的"重置密码"按钮</li>
            <li>在新页面中设置您的新密码</li>
          </ul>
        </div>
      </div>
    </div>
    
    <div class="foot">安全重置您的密码</div>
  </div>

    <script>
        // 显示不同状态
        function showState(stateName) {
            const states = ['requestForm', 'successState'];
            states.forEach(state => {
                document.getElementById(state).classList.add('hidden');
            });
            document.getElementById(stateName).classList.remove('hidden');
        }

        function showRequestForm() {
            showState('requestForm');
            hideMessages();
        }

        // 显示错误信息
        function showError(message) {
            const errorDiv = document.getElementById('errorDiv');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            document.getElementById('successDiv').classList.add('hidden');
        }

        // 显示成功信息
        function showSuccess(message) {
            const successDiv = document.getElementById('successDiv');
            successDiv.textContent = message;
            successDiv.classList.remove('hidden');
            document.getElementById('errorDiv').classList.add('hidden');
        }

        // 隐藏消息
        function hideMessages() {
            document.getElementById('errorDiv').classList.add('hidden');
            document.getElementById('successDiv').classList.add('hidden');
        }

        // 申请密码重置
        async function requestPasswordReset(event) {
            event.preventDefault();
            hideMessages();

            const email = document.getElementById('email').value.trim();
            const requestBtn = document.getElementById('requestBtn');

            // 验证邮箱
            if (!email) {
                showError('请输入邮箱地址');
                return;
            }

            if (!email.includes('@')) {
                showError('请输入有效的邮箱地址');
                return;
            }

            requestBtn.disabled = true;
            requestBtn.textContent = '发送中...';

            try {
                const response = await fetch('/api/auth/request-password-reset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email })
                });

                const data = await response.json();

                if (data.success) {
                    showState('successState');
                } else {
                    showError(data.message || '发送失败，请重试');
                }
            } catch (error) {
                console.error('申请密码重置失败:', error);
                showError('网络错误，请检查网络连接后重试');
            } finally {
                requestBtn.disabled = false;
                requestBtn.textContent = '发送重置邮件';
            }
        }

        // 页面加载时聚焦邮箱输入框
        window.addEventListener('load', () => {
            document.getElementById('email').focus();
        });
    </script>
</body>
</html>