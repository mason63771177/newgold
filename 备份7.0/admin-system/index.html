<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå°ç®¡ç†ç³»ç»Ÿ - H5ç½‘é¡µå·¥ç¨‹å¸ˆæ™ºèƒ½ä½“</title>
    <meta name="description" content="ç°ä»£åŒ–åå°ç®¡ç†ç³»ç»Ÿï¼ŒåŸºäºContext7 MCPæ ‡å‡†å¼€å‘">
    
    <!-- æ ·å¼æ–‡ä»¶ -->
    <link rel="stylesheet" href="./assets/css/base.css">
    <link rel="stylesheet" href="./assets/css/components.css">
    <link rel="stylesheet" href="./assets/css/layout.css">
    <link rel="stylesheet" href="./assets/css/dashboard.css">
    
    <!-- å›¾æ ‡å­—ä½“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
    <link rel="preload" href="./config/admin-config.json" as="fetch" crossorigin>
    <link rel="preload" href="./config/theme-config.json" as="fetch" crossorigin>
    <link rel="preload" href="./config/api-config.json" as="fetch" crossorigin>
</head>
<body>
    <!-- åŠ è½½å±å¹• -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner spinner-lg"></div>
            <div class="loading-text">æ­£åœ¨åŠ è½½ç®¡ç†ç³»ç»Ÿ...</div>
        </div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div id="admin-container" class="admin-container" style="display: none;">
        <!-- ä¾§è¾¹æ  -->
        <aside id="sidebar" class="sidebar">
            <!-- ä¾§è¾¹æ å¤´éƒ¨ -->
            <div class="sidebar-header">
                <a href="#" class="sidebar-logo">
                    <span class="logo-icon">ğŸ¯</span>
                    <span class="logo-text">ç®¡ç†ç³»ç»Ÿ</span>
                </a>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>

            <!-- ä¾§è¾¹æ å¯¼èˆª -->
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">ä¸»è¦åŠŸèƒ½</div>
                    <ul id="main-nav" class="nav-menu">
                        <!-- å¯¼èˆªé¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- ä¾§è¾¹æ é®ç½©ï¼ˆç§»åŠ¨ç«¯ï¼‰ -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
            <header class="top-navbar">
                <div class="navbar-left">
                    <button id="mobile-menu-toggle" class="mobile-menu-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <nav class="breadcrumb" id="breadcrumb">
                        <!-- é¢åŒ…å±‘å¯¼èˆªå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </nav>
                </div>

                <div class="navbar-right">
                    <!-- æœç´¢æ¡† -->
                    <div class="navbar-search">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" class="search-input" placeholder="æœç´¢åŠŸèƒ½...">
                    </div>

                    <!-- é€šçŸ¥ -->
                    <div class="navbar-notifications">
                        <i class="fas fa-bell notification-icon"></i>
                        <span class="notification-badge" id="notification-count">3</span>
                    </div>

                    <!-- ç”¨æˆ·ä¿¡æ¯ -->
                    <div class="navbar-user" id="user-dropdown">
                        <div class="user-avatar">A</div>
                        <div class="user-info">
                            <div class="user-name">ç®¡ç†å‘˜</div>
                            <div class="user-role">ç³»ç»Ÿç®¡ç†å‘˜</div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- é¡µé¢å†…å®¹ -->
            <div class="page-content">
                <div id="page-container">
                    <!-- é¡µé¢å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
            </div>
        </main>
    </div>

    <!-- é¡µé¢åŠ è½½å™¨å®¹å™¨ -->
    <div id="page-loader-container"></div>
    
    <!-- é€šçŸ¥å®¹å™¨ -->
    <div id="notification-container"></div>
    
    <!-- æ¨¡æ€æ¡†å®¹å™¨ -->
    <div id="modal-container"></div>

    <!-- Utility Scripts -->
    <script src="assets/js/utils/config-loader.js"></script>
    <script src="assets/js/utils/api-client.js"></script>
    <script src="assets/js/utils/event-bus.js"></script>
    
    <!-- Component Scripts -->
    <script src="assets/js/components/base-component.js"></script>
    <script src="assets/js/components/navigation.js"></script>
    <script src="assets/js/components/breadcrumb.js"></script>
    <script src="assets/js/components/page-loader.js"></script>
    <script src="assets/js/components/notification.js"></script>
    <script src="assets/js/components/modal.js"></script>
    
    <!-- Main Application Script -->
    <script src="assets/js/main.js"></script>

    <style>
        /* åŠ è½½å±å¹•æ ·å¼ */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-lg);
        }

        .loading-text {
            font-size: var(--font-size-base);
            color: var(--color-secondary-600);
        }

        /* é€šçŸ¥å®¹å™¨æ ·å¼ */
        .notification-container {
            position: fixed;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            z-index: var(--z-tooltip);
            max-width: 400px;
        }

        .notification {
            background-color: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--color-secondary-200);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            transform: translateX(100%);
            transition: transform var(--transition-normal);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-xs);
        }

        .notification-title {
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-size-sm);
        }

        .notification-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--color-secondary-500);
            padding: 0;
        }

        .notification-body {
            font-size: var(--font-size-sm);
            color: var(--color-secondary-600);
        }

        .notification.success {
            border-left: 4px solid var(--color-success);
        }

        .notification.warning {
            border-left: 4px solid var(--color-warning);
        }

        .notification.error {
            border-left: 4px solid var(--color-error);
        }

        .notification.info {
            border-left: 4px solid var(--color-info);
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 640px) {
            .notification-container {
                left: var(--spacing-sm);
                right: var(--spacing-sm);
                max-width: none;
            }
        }
    </style>

    <script>
        /**
         * åº”ç”¨ç¨‹åºåˆå§‹åŒ–
         * åŸºäºContext7 MCPæ ‡å‡†çš„æ¨¡å—åŒ–ç®¡ç†ç³»ç»Ÿ
         */
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // æ˜¾ç¤ºåŠ è½½å±å¹•
                const loadingScreen = document.getElementById('loading-screen');
                const adminContainer = document.getElementById('admin-container');

                // åˆå§‹åŒ–é…ç½®åŠ è½½å™¨
                await window.ConfigLoader.init();
                
                // åˆå§‹åŒ–APIå®¢æˆ·ç«¯
                await window.ApiClient.init();
                
                // åˆå§‹åŒ–äº‹ä»¶æ€»çº¿
                window.EventBus.init();
                
                // åˆå§‹åŒ–ç»„ä»¶ç³»ç»Ÿ
                await initializeComponents();
                
                // åˆå§‹åŒ–å¯¼èˆªç³»ç»Ÿ
                await window.Navigation.init();
                
                // åˆå§‹åŒ–é¡µé¢åŠ è½½å™¨
                await window.PageLoader.init();
                
                // åŠ è½½é»˜è®¤é¡µé¢
                await window.AdminApp.loadPage('dashboard');
                
                // éšè—åŠ è½½å±å¹•ï¼Œæ˜¾ç¤ºä¸»ç•Œé¢
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                    adminContainer.style.display = 'flex';
                    
                    // è§¦å‘åº”ç”¨å°±ç»ªäº‹ä»¶
                    window.EventBus.emit('app:ready');
                }, 500);
                
            } catch (error) {
                console.error('åº”ç”¨åˆå§‹åŒ–å¤±è´¥:', error);
                showErrorMessage('ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        });

        /**
         * åˆå§‹åŒ–ç»„ä»¶ç³»ç»Ÿ
         */
        async function initializeComponents() {
            // åˆå§‹åŒ–åŸºç¡€ç»„ä»¶
            window.BaseComponent.init();
            
            // åˆå§‹åŒ–å¯¼èˆªç»„ä»¶
            window.Navigation.init();
            
            // åˆå§‹åŒ–é¢åŒ…å±‘ç»„ä»¶
            window.Breadcrumb.init();
            
            // åˆå§‹åŒ–é€šçŸ¥ç»„ä»¶
            window.Notification.init();
            
            // åˆå§‹åŒ–æ¨¡æ€æ¡†ç»„ä»¶
            window.Modal.init();
        }

        /**
         * æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
         */
        function showErrorMessage(message) {
            const loadingScreen = document.getElementById('loading-screen');
            const loadingContent = loadingScreen.querySelector('.loading-content');
            
            loadingContent.innerHTML = `
                <div class="error-icon" style="font-size: 3rem; color: var(--color-error); margin-bottom: var(--spacing-lg);">âš ï¸</div>
                <div class="error-message" style="color: var(--color-error); text-align: center;">
                    <div style="font-weight: var(--font-weight-semibold); margin-bottom: var(--spacing-sm);">ç³»ç»Ÿé”™è¯¯</div>
                    <div style="font-size: var(--font-size-sm);">${message}</div>
                    <button onclick="location.reload()" class="btn btn-primary" style="margin-top: var(--spacing-lg);">
                        é‡æ–°åŠ è½½
                    </button>
                </div>
            `;
        }

        /**
         * å…¨å±€é”™è¯¯å¤„ç†
         */
        window.addEventListener('error', function(event) {
            console.error('å…¨å±€é”™è¯¯:', event.error);
            if (window.Notification) {
                window.Notification.show('ç³»ç»Ÿé”™è¯¯', 'å‘ç”Ÿäº†æœªé¢„æœŸçš„é”™è¯¯ï¼Œè¯·è”ç³»ç®¡ç†å‘˜', 'error');
            }
        });

        /**
         * æœªå¤„ç†çš„Promiseæ‹’ç»
         */
        window.addEventListener('unhandledrejection', function(event) {
            console.error('æœªå¤„ç†çš„Promiseæ‹’ç»:', event.reason);
            if (window.Notification) {
                window.Notification.show('ç½‘ç»œé”™è¯¯', 'è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•', 'warning');
            }
        });
    </script>
</body>
</html>